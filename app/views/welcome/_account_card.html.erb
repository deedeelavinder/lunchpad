<div class="card">
  <h3><%= "#{account.name}'s Lunchbox" %></h3>
  <% if account.orders.count > 0 %>
    <p><%= link_to "See all ordered lunches", account_orders_path(account) %></p>
  <% end %>

  <% if account.has_order_for(@start_date) %>
    <p><%= link_to "Edit lunch order for next week", edit_account_order_path(account_id: account, id: account.has_order_for(@start_date)) %>
  <% else %>
    <p><%= link_to "Order lunch for next week", new_account_order_path(account) %>
  <% end %>

  <p><%= link_to "Edit account", edit_account_path(account) %></p>

  <div class="lunchcov">

    <%= calendar table: {class: "table table-bordered"},
                 tr: {class: "calendar-row"},
                 td: {class: "day"},
                 header: {class: "calendar-header"},
                 events: @ordered_items,
                 day_names: "date.day_names",
                 number_of_days: 5,
                 # td: ->(start_date, current_calendar_date) { {class: "calendar-date", data: {day: current_calendar_date}} },
                 next_link: ->(param, date_range) { link_to "Go Forward, Dude.", {param => date_range.last + 3.day}, class: "mason" },
                 previous_link: ->(param, date_range) { link_to raw("&laquo;"), {param => date_range.first - 7.day} } do |date, ordered_items| %>

      <%= date %>

      <% ordered_items.each do |item| %>
        <div>
          <%= item.name %>
        </div>
      <% end %>
    <% end %>

    <%# if account.has_order_for(@start_date) %>
      <%# account.has_order_for(@start_date).lunch_coverage.each do |d| %>
        <%#= d.strftime("%A") %>
        <%# end %>
    <%# end %>
  </div>

  <p>  <%= "Account balance: $#{account.balance_dollars}" %></p>
</div>